<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
       <link href="layui/css/layui.css" rel="stylesheet">
     <link href="assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!-- Global styles END --> 
   
  <!-- Page level plugin styles START -->
  <link href="assets/plugins/fancybox/source/jquery.fancybox.css" rel="stylesheet">
  <link href="assets/plugins/owl.carousel/assets/owl.carousel.css" rel="stylesheet">
  <link href="assets/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css">
  <!-- Page level plugin styles END -->

  <!-- Theme styles START -->
  <link href="assets/pages/css/components.css" rel="stylesheet">
  <link href="assets/corporate/css/style.css" rel="stylesheet">
  <link href="assets/pages/css/style-shop.css" rel="stylesheet" type="text/css">
  <link href="assets/corporate/css/style-responsive.css" rel="stylesheet">
  <link href="assets/corporate/css/themes/red.css" rel="stylesheet" id="style-color">
  <link href="assets/corporate/css/custom.css" rel="stylesheet">
</head>
<body>
<div style="padding: 20px;" id="app">
        <div class="layui-form-item">
            订单号:<span style="margin-left: 20px;">{{ordermsg.ddno}}</span>
        </div>

        <div class="layui-form-item">
            商品信息:
            <span style="margin-left: 20px;">
            <template v-for="orderdetails in ordermsg.orderdetailslist">
                {{orderdetails.product.name}}&nbsp;&nbsp;*     {{orderdetails.num}}
            </template>
        </span>
        </div>

        <div class="layui-form-item">
            总金额:<span style="margin-left: 20px;color:darkred">{{ordermsg.total}}RMB</span>
        </div>
 		<div  class="form-group">
            <select v-model="mjhb" class="form-control">
                <option value="请选择支付方式">请选择支付方式</option>
		     	<option value="">微信 </option>
				<option value="">支付宝 </option>
				<option value="">银行卡 </option>
            </select>
        </div>
        <div class="layui-form-item">
                <input type="text" v-model="zhanghao" required  lay-verify="required" placeholder="支付帐号" autocomplete="off" class="layui-input">
        </div>

        <div class="layui-form-item">
            <input type="password" v-model="mima" required  lay-verify="required" placeholder="支付密码" autocomplete="off" class="layui-input">
        </div>

        <div class="layui-form-item">
                <a class="layui-btn" lay-submit lay-filter="formDemo" @click="fukuan()">付款</a>
        </div>

</div>
 <script src="assets/plugins/jquery.min.js" type="text/javascript"></script>
    <script src="assets/plugins/jquery-migrate.min.js" type="text/javascript"></script>
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>      
    <script src="assets/corporate/scripts/back-to-top.js" type="text/javascript"></script>

    <!-- END CORE PLUGINS -->

    <!-- BEGIN PAGE LEVEL JAVASCRIPTS (REQUIRED ONLY FOR CURRENT PAGE) -->
    <script src="assets/plugins/fancybox/source/jquery.fancybox.pack.js" type="text/javascript"></script><!-- pop up -->
    <script src="assets/plugins/owl.carousel/owl.carousel.min.js" type="text/javascript"></script><!-- slider for products -->
    <script src='assets/plugins/zoom/jquery.zoom.min.js' type="text/javascript"></script><!-- product zoom -->
    <script src="assets/plugins/bootstrap-touchspin/bootstrap.touchspin.js" type="text/javascript"></script><!-- Quantity -->
    <script src="assets/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>

    <script src="assets/corporate/scripts/layout.js" type="text/javascript"></script>
    <script src="assets/pages/scripts/checkout.js" type="text/javascript"></script>
</body>
<script type="text/javascript" src="axios/vue.js"></script>
<script type="text/javascript" src="axios/axios.min.js"></script>
<script type="text/javascript" src="axios/qs.js"></script>
<script type="text/javascript" src="axios/getUrlParams.js"></script>
<script type="text/javascript" src="layer/layer.js"></script>
<script type="text/javascript" src="layui/layui.js"></script>
<script type="text/javascript">
    var qs = Qs
    var id = UrlParam.paramValues("id").toString()
    var vmm = new Vue({
        el: '#app',
        data: {
            filename:"",
            id:id,
            ordermsg:"",
            zhanghao:"",
            mima:"",
            mjhb:"请选择支付方式",
        },
        mounted(){
            this.show()
        },
        methods: {
            fukuan() {
                if(this.zhanghao==""){
                    layer.msg("支付帐号不能为空",{icon:5})
                    return false;
                }
                if(this.mima==""){
                    layer.msg("支付密码不能为空",{icon:5})
                    return false;
                }
                axios.post('fukuan',qs.stringify({
                    id:this.id,
                })).then(response =>{
                    if(response.data.data == 200){
                        layer.alert("支付成功，等待卖家发货",{icon:6},function(){
                            window.parent.layer.closeAll();
                            window.parent.location.reload();
                        })
                    }else{
                        layer.alert("支付失败，订单中存在已出售的商品",{icon:5},function(){
                            window.parent.layer.closeAll();
                            window.parent.location.reload();
                        })
                    }

                }).catch(error =>{
                    console.log(error)
                })
            },

            show() {
                axios.post('member/ordermsgShow',qs.stringify({
                    id:this.id,
                })).then(response =>{
                    this.ordermsg = response.data.ordermsg
                }).catch(error =>{
                    console.log(error)
                })
            },





        }
    });
</script>
</html>